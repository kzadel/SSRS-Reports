<?xml version="1.0" encoding="utf-8"?>
<Report xmlns="http://schemas.microsoft.com/sqlserver/reporting/2008/01/reportdefinition" xmlns:rd="http://schemas.microsoft.com/SQLServer/reporting/reportdesigner">
  <Body>
    <ReportItems>
      <Textbox Name="textbox1">
        <CanGrow>true</CanGrow>
        <KeepTogether>true</KeepTogether>
        <Paragraphs>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>="DSR Inventory Report as of End of Day " + Format(First(CDate(Fields!CalDayStr.Value), "EndOfDay"), "M/d/y")</Value>
                <Style>
                  <FontWeight>Bold</FontWeight>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
          <Paragraph>
            <TextRuns>
              <TextRun>
                <Value>Note: </Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                </Style>
              </TextRun>
              <TextRun>
                <Value>Packs have been In Transit DSR equal to or more than </Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <TextDecoration>None</TextDecoration>
                </Style>
              </TextRun>
              <TextRun>
                <Value>=Parameters!days.Label</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <TextDecoration>None</TextDecoration>
                </Style>
              </TextRun>
              <TextRun>
                <Value>. Selected Pack Type: </Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <TextDecoration>None</TextDecoration>
                </Style>
              </TextRun>
              <TextRun>
                <Value>=Join(Parameters!FullPackFlag.Label, ", ")</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <TextDecoration>None</TextDecoration>
                </Style>
              </TextRun>
              <TextRun>
                <Value>.</Value>
                <Style>
                  <FontStyle>Italic</FontStyle>
                  <FontSize>8pt</FontSize>
                  <FontWeight>Normal</FontWeight>
                  <TextDecoration>None</TextDecoration>
                </Style>
              </TextRun>
            </TextRuns>
            <Style />
          </Paragraph>
        </Paragraphs>
        <rd:DefaultName>textbox1</rd:DefaultName>
        <Top>0.0375in</Top>
        <Left>0.0625in</Left>
        <Height>0.34959in</Height>
        <Width>5.81874in</Width>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
          <PaddingLeft>2pt</PaddingLeft>
          <PaddingRight>2pt</PaddingRight>
          <PaddingTop>2pt</PaddingTop>
          <PaddingBottom>2pt</PaddingBottom>
        </Style>
      </Textbox>
      <Tablix Name="Tablix2">
        <TablixCorner>
          <TablixCornerRows>
            <TablixCornerRow>
              <TablixCornerCell>
                <CellContents>
                  <Textbox Name="Textbox42">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=CInt(Fields!SalesRepUserId.Value)</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Current Location</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox17</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixCornerCell>
            </TablixCornerRow>
          </TablixCornerRows>
        </TablixCorner>
        <TablixBody>
          <TablixColumns>
            <TablixColumn>
              <Width>0.8in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.65625in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.58333in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.83333in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>0.95833in</Width>
            </TablixColumn>
            <TablixColumn>
              <Width>1.1875in</Width>
            </TablixColumn>
          </TablixColumns>
          <TablixRows>
            <TablixRow>
              <Height>0.20833in</Height>
              <TablixCells>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="Textbox45">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=iif(isNothing(Fields!PreviousLocation.Value), "n/a", Fields!PreviousLocation.Value)</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>Textbox5</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="ProductNumber">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!ProductNumber.Value</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>ProductNumber</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="SerialNumber">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!SerialNumber.Value</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>SerialNumber</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="TicketCount">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!TicketCount.Value</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>TicketCount</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="DateKey">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Format(CDate(Fields!StatusChangeDate.Value), "M/d/yy")</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>DateKey</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
                <TablixCell>
                  <CellContents>
                    <Textbox Name="NumberOfDaysInTransitDSR">
                      <CanGrow>true</CanGrow>
                      <KeepTogether>true</KeepTogether>
                      <Paragraphs>
                        <Paragraph>
                          <TextRuns>
                            <TextRun>
                              <Value>=Fields!NumberOfDaysInTransitDSR.Value</Value>
                              <Style>
                                <FontSize>8pt</FontSize>
                              </Style>
                            </TextRun>
                          </TextRuns>
                          <Style>
                            <TextAlign>Center</TextAlign>
                          </Style>
                        </Paragraph>
                      </Paragraphs>
                      <rd:DefaultName>NumberOfDaysInTransitDSR</rd:DefaultName>
                      <Style>
                        <Border>
                          <Color>LightGrey</Color>
                          <Style>Solid</Style>
                        </Border>
                        <BackgroundColor>White</BackgroundColor>
                        <PaddingLeft>2pt</PaddingLeft>
                        <PaddingRight>2pt</PaddingRight>
                        <PaddingTop>2pt</PaddingTop>
                        <PaddingBottom>2pt</PaddingBottom>
                      </Style>
                    </Textbox>
                  </CellContents>
                </TablixCell>
              </TablixCells>
            </TablixRow>
          </TablixRows>
        </TablixBody>
        <TablixColumnHierarchy>
          <TablixMembers>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox23">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=CInt(Fields!PreviousLocation.Value)</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>From</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Retailer</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox4</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox41">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=CInt(Fields!ProductNumber.Value)</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Game</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox41</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox44">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=CInt(Fields!SerialNumber.Value)</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Pack</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox44</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox47">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=Fields!TicketCount.Value</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value># of Tickets</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox47</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox49">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=CDate(Fields!StatusChangeDate.Value)</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>Status Change Dt</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox49</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
            <TablixMember>
              <TablixHeader>
                <Size>0.35417in</Size>
                <CellContents>
                  <Textbox Name="Textbox51">
                    <CanGrow>true</CanGrow>
                    <UserSort>
                      <SortExpression>=Fields!NumberOfDaysInTransitDSR.Value</SortExpression>
                    </UserSort>
                    <KeepTogether>true</KeepTogether>
                    <Paragraphs>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value># Days </Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                      <Paragraph>
                        <TextRuns>
                          <TextRun>
                            <Value>In Transit DSR</Value>
                            <Style>
                              <FontSize>8pt</FontSize>
                              <FontWeight>Bold</FontWeight>
                              <Color>White</Color>
                            </Style>
                          </TextRun>
                        </TextRuns>
                        <Style>
                          <TextAlign>Center</TextAlign>
                        </Style>
                      </Paragraph>
                    </Paragraphs>
                    <rd:DefaultName>Textbox51</rd:DefaultName>
                    <Style>
                      <Border>
                        <Color>LightGrey</Color>
                        <Style>Solid</Style>
                      </Border>
                      <BackgroundColor>SteelBlue</BackgroundColor>
                      <PaddingLeft>2pt</PaddingLeft>
                      <PaddingRight>2pt</PaddingRight>
                      <PaddingTop>2pt</PaddingTop>
                      <PaddingBottom>2pt</PaddingBottom>
                    </Style>
                  </Textbox>
                </CellContents>
              </TablixHeader>
            </TablixMember>
          </TablixMembers>
        </TablixColumnHierarchy>
        <TablixRowHierarchy>
          <TablixMembers>
            <TablixMember>
              <Group Name="CurrentLocation" />
              <SortExpressions>
                <SortExpression>
                  <Value>=Fields!SalesRepUserId.Value</Value>
                </SortExpression>
                <SortExpression>
                  <Value>=Fields!ProductNumber.Value</Value>
                </SortExpression>
                <SortExpression>
                  <Value>=Fields!SerialNumber.Value</Value>
                </SortExpression>
              </SortExpressions>
              <TablixMembers>
                <TablixMember>
                  <TablixHeader>
                    <Size>0.8in</Size>
                    <CellContents>
                      <Textbox Name="Retailer_Number2">
                        <CanGrow>true</CanGrow>
                        <KeepTogether>true</KeepTogether>
                        <Paragraphs>
                          <Paragraph>
                            <TextRuns>
                              <TextRun>
                                <Value>=Fields!SalesRepUserId.Value</Value>
                                <Style>
                                  <FontSize>8pt</FontSize>
                                </Style>
                              </TextRun>
                            </TextRuns>
                            <Style />
                          </Paragraph>
                        </Paragraphs>
                        <rd:DefaultName>Retailer_Number1</rd:DefaultName>
                        <Style>
                          <Border>
                            <Color>LightGrey</Color>
                            <Style>Solid</Style>
                          </Border>
                          <BackgroundColor>White</BackgroundColor>
                          <PaddingLeft>2pt</PaddingLeft>
                          <PaddingRight>2pt</PaddingRight>
                          <PaddingTop>2pt</PaddingTop>
                          <PaddingBottom>2pt</PaddingBottom>
                        </Style>
                      </Textbox>
                    </CellContents>
                  </TablixHeader>
                  <TablixMembers>
                    <TablixMember />
                  </TablixMembers>
                </TablixMember>
              </TablixMembers>
            </TablixMember>
          </TablixMembers>
        </TablixRowHierarchy>
        <RepeatColumnHeaders>true</RepeatColumnHeaders>
        <FixedColumnHeaders>true</FixedColumnHeaders>
        <DataSetName>ReturnsExceptions</DataSetName>
        <Top>0.4214in</Top>
        <Left>0.0625in</Left>
        <Height>0.5625in</Height>
        <Width>5.81874in</Width>
        <ZIndex>1</ZIndex>
        <Style>
          <Border>
            <Style>None</Style>
          </Border>
        </Style>
      </Tablix>
    </ReportItems>
    <Height>0.9839in</Height>
    <Style />
  </Body>
  <Width>5.88124in</Width>
  <Page>
    <LeftMargin>1in</LeftMargin>
    <RightMargin>1in</RightMargin>
    <TopMargin>1in</TopMargin>
    <BottomMargin>1in</BottomMargin>
    <Style />
  </Page>
  <AutoRefresh>0</AutoRefresh>
  <DataSources>
    <DataSource Name="BIDW">
      <DataSourceReference>BIDW</DataSourceReference>
      <rd:SecurityType>None</rd:SecurityType>
      <rd:DataSourceID>5100255f-95e8-4297-a010-d3204acf7739</rd:DataSourceID>
    </DataSource>
  </DataSources>
  <DataSets>
    <DataSet Name="ReturnsExceptions">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <QueryParameters>
          <QueryParameter Name="@d">
            <Value>=Parameters!d.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@days">
            <Value>=Parameters!days.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@r">
            <Value>=Parameters!r.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@DistrictCode">
            <Value>=Parameters!DistrictCode.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@FullPackFlag">
            <Value>=Parameters!FullPackFlag.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@GameStatus">
            <Value>=Parameters!GameStatus.Value</Value>
          </QueryParameter>
          <QueryParameter Name="@Product">
            <Value>=Parameters!Product.Value</Value>
          </QueryParameter>
        </QueryParameters>
        <CommandText>/* Return Exceptions */
/* Modified: 2013-07-16 */

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

-- Variables only used for testing this script in SSMS
--DECLARE @d INT = '20130707';
--DECLARE @days INT = '-6'   -- 7days   -- 0 is for 1 day, -6 is for 7 days, -13 is for 14 days, -27 is for 28 days
--DECLARE @FullPackFlag INT = '1'		-- 1 means Full Pack, 0 means Partial Pack
--DECLARE @DistrictCode INT = '021';
--DECLARE @r INT = '21026';	--DSR
--DECLARE @Product INT = '855'
--DECLARE @GameStatus INT = '1' -- 2 (Beyond retailer sales end date) means game Has Ended, 1 (Not beyond retailer sales end date) means games has not ended

--  Move passed parameters into working fields
DECLARE @DateKey INT = @d;

-- Get processing dates
DECLARE @CalDayDate DATETIME = (SELECT TOP 1 CalDayDate FROM BIDW.dbo.DimDate WHERE @DateKey = DateKey);
DEClARE @StartDateKey INT = (SELECT TOP 1 DateKey FROM BIDW.dbo.DimDate WHERE CalDayDate = DATEADD(dd, CONVERT(INT, @days), @CalDayDate));


SELECT	StatusChangeDate = CONVERT(DATE, CONVERT(VARCHAR(10), DateKey), 10)
,		NumberOfDaysInTransitDSR = (DATEDIFF(DAY,CONVERT(VARCHAR(10),DateKey,10),CONVERT(VARCHAR(10),@d,10))) +1
,		ProductNumber
,		SerialNumber = CONVERT(VARCHAR, SerialNumber)
,		TicketCount
,		CAST(PricePointAmount AS INT) AS PricePointAmount
,		ProductLaunchDate
,		ProductDesc
,		P.ProductDisableDate
,		StatusDesc
,		PS.SalesRepKey
,		DistrictCode = LEFT(SR.SalesRepUserId, 3)
,		SalesRepUserId = RIGHT(SR.SalesRepUserId, 5)
,		SalesRepUserName
,		FullPackFlag
,		PreviousLocation = R.RetailerId
,		PastEndedGame = CASE WHEN (DATEDIFF(DD,@CalDayDate,P.ProductDisableDate) &lt;= 181) THEN 1 ELSE 0 END --1 is a date beyond the Retailer End of Sale Date, 0 means game has not ended 
,		EndedGameDate = DATEADD(DD,-181,P.ProductDisableDate)											   --Retailer End of Sale Date
,		PS.OrderKey
FROM	BIDW.dbo.FactPackSnapshot PS
		INNER JOIN 
		BIDW.dbo.DimProduct P
		ON PS.ProductKey = P.ProductKey
		LEFT OUTER JOIN BIDW.dbo.FactOrderDetail OD
		ON PS.OrderKey = OD.OrderKey
		LEFT OUTER JOIN BIDW.dbo.DimRetailer R
		ON R.RetailerKey = OD.RetailerKey
		INNER JOIN
		BIDW.dbo.DimSalesRep SR
		ON PS.SalesRepKey = SR.SalesRepKey
WHERE StatusCode = 6	-- InTransitDSR
AND PS.DateKey &lt;= @StartDateKey -- Equal to or more than x days ago		
AND	ProductLaunchDate &gt; '2011-01-01' -- Exclude games launched before Jan 2011
AND RIGHT(SR.SalesRepUserId, 5) IN (@r)
AND LEFT(SR.SalesRepUserId, 3) IN (@DistrictCode)
AND FullPackFlag IN (@FullPackFlag)
AND ProductNumber IN (@Product)
AND (CASE WHEN (DATEDIFF(DD,@CalDayDate,P.ProductDisableDate) &lt;= 181) THEN 2 ELSE 1 END) IN (@GameStatus) -- 2 (Y) means game Has Ended, 1 (N) means games has not ended
GROUP BY Datekey
,		ProductNumber
,		SerialNumber
,		TicketCount
,		PricePointAmount
,		ProductLaunchDate
,		ProductDesc
,		P.ProductDisableDate
,		StatusDesc
,		PS.SalesRepKey
,		SR.SalesRepUserId
,		SR.SalesRepUserName
,		FullPackFlag
,		PS.OrderKey
,		RetailerId
ORDER BY SalesRepUserId, ProductNumber, SerialNumber</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="StatusChangeDate">
          <DataField>StatusChangeDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="NumberOfDaysInTransitDSR">
          <DataField>NumberOfDaysInTransitDSR</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ProductNumber">
          <DataField>ProductNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SerialNumber">
          <DataField>SerialNumber</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="TicketCount">
          <DataField>TicketCount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="PricePointAmount">
          <DataField>PricePointAmount</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ProductLaunchDate">
          <DataField>ProductLaunchDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="ProductDesc">
          <DataField>ProductDesc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="ProductDisableDate">
          <DataField>ProductDisableDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="StatusDesc">
          <DataField>StatusDesc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesRepKey">
          <DataField>SalesRepKey</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="DistrictCode">
          <DataField>DistrictCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesRepUserId">
          <DataField>SalesRepUserId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesRepUserName">
          <DataField>SalesRepUserName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="FullPackFlag">
          <DataField>FullPackFlag</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="PastEndedGame">
          <DataField>PastEndedGame</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="PreviousLocation">
          <DataField>PreviousLocation</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="EndedGameDate">
          <DataField>EndedGameDate</DataField>
          <rd:TypeName>System.DateTime</rd:TypeName>
        </Field>
        <Field Name="OrderKey">
          <DataField>OrderKey</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="EndOfDay">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>SELECT DISTINCT TOP 1 B.DateKey
, CalDayStr
FROM BIDW.dbo.LkpRetailerBaseDaily A 
INNER JOIN BIDW.dbo.DimDate B 
ON A.DateKey = B.DateKey
ORDER BY B.DateKey DESC</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="DateKey">
          <DataField>DateKey</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="CalDayStr">
          <DataField>CalDayStr</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="days">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>SELECT DISTINCT MoreThanXDaysKey = (ProductNumber * -1)
, DaysInfo = CONVERT(VARCHAR(30),(ProductNumber + 1)) + CASE WHEN ProductNumber = 0 THEN ' day' ELSE ' days' END
FROM    BIDW.dbo.DimProduct
WHERE (ProductNumber = 0) -- 1 day
OR	(ProductNumber = 6)  -- 7 days
OR	(ProductNumber = 13) -- 14 days
OR	(ProductNumber = 27) -- 28 days
ORDER BY MoreThanXDaysKey DESC</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="MoreThanXDaysKey">
          <DataField>MoreThanXDaysKey</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="DaysInfo">
          <DataField>DaysInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DSR">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>/* All DSRs that have In Transit DSRs */
/* Modified: 2015-02-23 */

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

SELECT	DISTINCT SalesRepUserId = RIGHT(SR.SalesRepUserId, 5)
,		SalesRepUserName
,		SalesRepTypeDesc
,		DSRInfo = (cast(RIGHT(SR.SalesRepUserId, 5) as varchar) + ' - ' + Upper(SalesRepUserName))
FROM	BIDW.dbo.FactPackSnapshot PS
		INNER JOIN 
		BIDW.dbo.DimProduct P
		ON PS.ProductKey = P.ProductKey
		LEFT OUTER JOIN BIDW.dbo.FactOrderDetail OD
		ON PS.OrderKey = OD.OrderKey
		LEFT OUTER JOIN BIDW.dbo.DimRetailer R
		ON R.RetailerKey = OD.RetailerKey
		INNER JOIN
		BIDW.dbo.DimSalesRep SR
		ON PS.SalesRepKey = SR.SalesRepKey
WHERE StatusCode = 6	-- InTransitDSR	
AND	ProductLaunchDate &gt; '2011-01-01' -- Exclude games launched before Jan 2011
AND LEFT(SR.SalesRepUserId, 3) != '051' -- Exclude RSRs
ORDER BY SalesRepUserId</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="SalesRepUserId">
          <DataField>SalesRepUserId</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesRepUserName">
          <DataField>SalesRepUserName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="SalesRepTypeDesc">
          <DataField>SalesRepTypeDesc</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DSRInfo">
          <DataField>DSRInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="DO">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>SELECT DISTINCT DistrictCode
,DistrictName
FROM BIDW.dbo.DimRetailer
WHERE DistrictName IS NOT NULL 
AND DistrictCode &lt;&gt; '030' 
AND DistrictCode &lt;&gt; '035' 
AND DistrictCode &lt;&gt; '032'
ORDER BY DistrictName</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="DistrictCode">
          <DataField>DistrictCode</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="DistrictName">
          <DataField>DistrictName</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="FullPackFlag">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>SELECT DISTINCT ProductNumber AS FullPackKey
, PackInfo = CASE WHEN ProductNumber = 1 THEN 'Full' ELSE 'Partial' END
FROM    BIDW.dbo.DimProduct
WHERE   (ProductNumber = 0) -- 0 for partial pack
OR	(ProductNumber = 1)  -- 1 for full pack
ORDER BY ProductNumber DESC</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="FullPackKey">
          <DataField>FullPackKey</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="PackInfo">
          <DataField>PackInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="FullPackFlagDefault">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>SELECT DISTINCT ProductNumber AS FullPackKey
, PackInfo = CASE WHEN ProductNumber = 1 THEN 'Full' ELSE 'Partial' END
FROM    BIDW.dbo.DimProduct
WHERE  (ProductNumber = 1)  -- 1 for full pack
ORDER BY ProductNumber DESC</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="FullPackKey">
          <DataField>FullPackKey</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
        <Field Name="PackInfo">
          <DataField>PackInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="GameStatus">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>/* End of Game Status */
/* Modified: 2013-06-17 */
/* 2 (Beyond retailer sales end date) means game Has Ended, 1 (Not beyond retailer sales end date) means games has not ended */

SELECT DISTINCT DayNum AS GamesStatusKey
, GamesStatusInfo = CASE WHEN DayNum = 1 
			THEN 'Not beyond retailer sales end date'
		    ELSE 'Beyond retailer sales end date' 
			END
FROM    BIDW.dbo.DimReportPeriod
WHERE   (DayNum = 1)
OR	(DayNum =  2)  
ORDER BY GamesStatusKey
</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="GamesStatusKey">
          <DataField>GamesStatusKey</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="GamesStatusInfo">
          <DataField>GamesStatusInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
    <DataSet Name="Product">
      <Query>
        <DataSourceName>BIDW</DataSourceName>
        <CommandText>/* Return Exceptions Product Numbers */
/* Modified: 2014-12-02 */

SET TRANSACTION ISOLATION LEVEL READ UNCOMMITTED;

SELECT DISTINCT ProductNumber = CONVERT(INT,ProductNumber)
, ProductInfo = CONVERT(VARCHAR(10), ProductNumber) + ' - ' + ProductDesc
FROM	BIDW.dbo.FactPackSnapshot PS
		INNER JOIN 
		BIDW.dbo.DimProduct P
		ON PS.ProductKey = P.ProductKey
WHERE StatusCode = 6	-- InTransitDSR	
AND	ProductLaunchDate &gt; '2011-01-01' -- Exclude games launched before Jan 2011
Order by CONVERT(INT,ProductNumber) DESC</CommandText>
        <rd:UseGenericDesigner>true</rd:UseGenericDesigner>
      </Query>
      <Fields>
        <Field Name="ProductNumber">
          <DataField>ProductNumber</DataField>
          <rd:TypeName>System.Int32</rd:TypeName>
        </Field>
        <Field Name="ProductInfo">
          <DataField>ProductInfo</DataField>
          <rd:TypeName>System.String</rd:TypeName>
        </Field>
      </Fields>
    </DataSet>
  </DataSets>
  <ReportParameters>
    <ReportParameter Name="d">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>EndOfDay</DataSetName>
          <ValueField>DateKey</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Date</Prompt>
      <Hidden>true</Hidden>
      <ValidValues>
        <DataSetReference>
          <DataSetName>EndOfDay</DataSetName>
          <ValueField>DateKey</ValueField>
          <LabelField>CalDayStr</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="r">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DSR</DataSetName>
          <ValueField>SalesRepUserId</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Rep</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DSR</DataSetName>
          <ValueField>SalesRepUserId</ValueField>
          <LabelField>DSRInfo</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="DistrictCode">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>DO</DataSetName>
          <ValueField>DistrictCode</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>District</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>DO</DataSetName>
          <ValueField>DistrictCode</ValueField>
          <LabelField>DistrictName</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="days">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>days</DataSetName>
          <ValueField>MoreThanXDaysKey</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>In Transit DSR equal to or more than</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>days</DataSetName>
          <ValueField>MoreThanXDaysKey</ValueField>
          <LabelField>DaysInfo</LabelField>
        </DataSetReference>
      </ValidValues>
    </ReportParameter>
    <ReportParameter Name="FullPackFlag">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>FullPackFlagDefault</DataSetName>
          <ValueField>FullPackKey</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Packs</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>FullPackFlag</DataSetName>
          <ValueField>FullPackKey</ValueField>
          <LabelField>PackInfo</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="GameStatus">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>GameStatus</DataSetName>
          <ValueField>GamesStatusKey</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Include games</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>GameStatus</DataSetName>
          <ValueField>GamesStatusKey</ValueField>
          <LabelField>GamesStatusInfo</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
    <ReportParameter Name="Product">
      <DataType>String</DataType>
      <DefaultValue>
        <DataSetReference>
          <DataSetName>Product</DataSetName>
          <ValueField>ProductNumber</ValueField>
        </DataSetReference>
      </DefaultValue>
      <Prompt>Game</Prompt>
      <ValidValues>
        <DataSetReference>
          <DataSetName>Product</DataSetName>
          <ValueField>ProductNumber</ValueField>
          <LabelField>ProductInfo</LabelField>
        </DataSetReference>
      </ValidValues>
      <MultiValue>true</MultiValue>
    </ReportParameter>
  </ReportParameters>
  <rd:ReportUnitType>Inch</rd:ReportUnitType>
  <rd:ReportID>041a89a6-06d3-41a0-a8a7-e4603fed8925</rd:ReportID>
</Report>